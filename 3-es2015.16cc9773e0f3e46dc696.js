(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{wQCW:function(e,t,n){"use strict";n.r(t),n.d(t,"VereineModule",(function(){return O}));var i=n("ofXK"),s=n("3Pt+"),a=n("tyNb"),l=n("FpXt"),o=n("tY1a");const r={moduleTranslationKey:"VEREINE",pageTitleTranslationKey:"VEREINE.VEREINE.TITLE",navigationCardsConfig:{navigationCards:[]}},h={columns:[{translationKey:"VEREINE.VEREINE.TABLE.HEADERS.VERANSTALTUNG",propertyName:"veranstaltung_name",width:20},{translationKey:"VEREINE.VEREINE.TABLE.HEADERS.WETTKAMPF",propertyName:"wettkampfTag",width:20},{translationKey:"TABLE.PLACE",propertyName:"wettkampfOrt",width:20},{translationKey:"VEREINE.VEREINE.TABLE.HEADERS.MANNSCHAFT",propertyName:"mannschaftsName",width:20}],actions:{actionTypes:[o.a.MAP],width:6}};var c=n("X628"),d=n("FlTZ"),p=n("PEb7"),g=(n("YfBl"),n("ny2l")),u=n("sQ0O"),f=n("nr0C");class b{constructor(e,t,n,i){this.veranstaltung_name=e,this.wettkampfTag=t,this.wettkampfOrt=n,this.mannschaftsName=i,this.id=1,this.version=1}}var m=n("gQPg"),V=n("fXoL"),w=n("U9hD"),E=n("hIfO"),T=n("zLSN"),y=n("xOPY");const v=function(e){return[e]};let D=(()=>{class e extends p.CommonComponentDirective{constructor(e,t,n,i,s,a,l){super(),this.router=e,this.route=t,this.notificationService=n,this.wettkampfDataProvider=i,this.veranstaltungsDataProvider=s,this.vereinDataProvider=a,this.mannschaftsDataProvider=l,this.PLACEHOLDER_VAR="Bitte Verein eingeben...",this.config=r,this.config_table=h,this.multipleSelections=!0,this.loadingVereine=!0,this.loadingTable=!1,this.tableContent=[]}ngOnInit(){console.log("Bin in Vereine"),this.currentVerein=null,this.providedID=null,this.hasID=!1,this.loading=!0,this.notificationService.discardNotification(),this.route.params.subscribe(e=>{Object(c.c)(e.id)||(this.hasID=!0,this.providedID=parseInt(e.id,10),console.log("This.providedID: "+this.providedID))}),this.loadVereine()}changeSelectedVerein(){this.selectedVereine=[],this.vereinDataProvider.findById(this.selectedVereinsId).then(e=>this.getVereinSuccsess(e.payload)).catch(e=>console.log("Fehler im Verein laden"))}getVereinSuccsess(e){console.log("response in getVerein: "+e.name),this.currentVerein=e,this.selectedVereine.push(this.currentVerein),console.log("CurrentVerein: "+this.currentVerein)}onSelect(e){this.selectedDTOs=[],this.selectedDTOs=e,this.selectedDTOs&&this.selectedDTOs.length>0&&(this.selectedVereinsId=this.selectedDTOs[0].id),this.changeVerein()}changeVerein(){this.rows=[],this.tableContent=[],null!=this.selectedVereinsId&&this.loadTableRows()}getSelectedDTO(){if(Object(c.a)(this.selectedDTOs))return"";{console.log("Auswahllisten: selectedDTO = "+JSON.stringify(this.selectedDTOs));const e=[];return this.selectedDTOs.forEach(t=>{e.push(t.name)}),e.join(", ")}}onView(e){}onEdit(e){}onDelete(e){}onMap(e){let t;t=e.wettkampfOrt.split(", ",5),window.open("https://www.google.de/maps/place/"+t[0]+"+"+t[1]+"+"+t[2])}loadVereine(){this.vereine=[],this.vereinDataProvider.findAll().then(e=>{this.vereine=e.payload.sort(),this.loadingVereine=!1,this.selectedVereinsId=this.hasID?this.providedID:e.payload[0].id,console.log("This.selectedVereinsID: "+this.selectedVereinsId),this.changeSelectedVerein(),this.onSelect(this.selectedVereine)}).catch(e=>{this.vereine=e.payload})}loadTableRows(){this.loadingTable=!0,this.mannschaftsDataProvider.findAllByVereinsId(this.selectedVereinsId).then(e=>this.handleFindMannschaftenSuccess(e)).catch(e=>this.handleFindMannschaftenFailure(e))}handleFindMannschaftenFailure(e){this.rows=[],this.loadingTable=!1}handleFindMannschaftenSuccess(e){let t;for(this.rows=[],this.remainingMannschaftsRequests=e.payload.length,e.payload.length<=0&&(this.loadingTable=!1),t=0;t<e.payload.length;t++){const n=this.selectedDTOs[0].name+" "+e.payload[t].nummer+". Mannschaft";this.wettkampfDataProvider.findAllWettkaempfeByMannschaftsId(e.payload[t].id).then(e=>this.handleFindWettkaempfeSuccess(e,n)).catch(e=>this.handleFindWettkaempfeFailure(e))}}handleFindWettkaempfeFailure(e){this.rows=[],this.loadingTable=!1}handleFindWettkaempfeSuccess(e,t){console.log("success"),this.remainingRequests=e.payload.length,this.remainingMannschaftsRequests-=1,e.payload.length<=0&&(this.loadingTable=!1);for(const n of e.payload){const e=n.wettkampfTag+". Wettkampftag",i=n.wettkampfOrt;this.veranstaltungsDataProvider.findById(n.wettkampfVeranstaltungsId).then(n=>this.handleFindVeranstaltungSuccess(n,t,e,i)).catch(e=>this.handleFindVeranstaltungFailure(e))}if(0===e.payload.length){const e=new b("","","",t);this.tableContent.push(e)}this.remainingMannschaftsRequests<=0&&(this.rows=Object(p.toTableRows)(this.tableContent))}handleFindVeranstaltungFailure(e){this.rows=[],this.loadingTable=!1}handleFindVeranstaltungSuccess(e,t,n,i){console.log("Content:"+e.payload.name+n+t);const s=new b(e.payload.name,n,i,t);this.tableContent.push(s),this.remainingRequests-=1,this.remainingRequests<=0&&(this.rows=Object(p.toTableRows)(this.tableContent),this.tableContent=[],this.loadingTable=!1)}}return e.\u0275fac=function(t){return new(t||e)(V.Jb(a.c),V.Jb(a.a),V.Jb(m.c),V.Jb(u.a),V.Jb(f.a),V.Jb(d.a),V.Jb(g.a))},e.\u0275cmp=V.Db({type:e,selectors:[["bla-vereine"]],features:[V.ub],decls:8,vars:13,consts:[[3,"config"],[1,"row"],["selectionListHeight","15em",2,"width","50%","flex-grow","0",3,"selectedItemIds","items","loading","multipleSelections","placeholderTranslationKey","optionFieldSelector","onSelect"],[3,"config","loading","rows","onMapEntry"]],template:function(e,t){1&e&&(V.Ob(0,"bla-navigation-dialog",0),V.Ob(1,"div",1),V.Ob(2,"bla-col-layout"),V.Ob(3,"h2"),V.uc(4),V.Nb(),V.Ob(5,"bla-quicksearch-list",2),V.Vb("onSelect",(function(e){return t.onSelect(e)})),V.Nb(),V.Nb(),V.Nb(),V.Ob(6,"div",1),V.Ob(7,"bla-data-table",3),V.Vb("onMapEntry",(function(e){return t.onMap(e)})),V.Nb(),V.Nb(),V.Nb()),2&e&&(V.dc("config",t.config),V.xb(4),V.wc("Vereinsauswahl: ",t.getSelectedDTO(),""),V.xb(1),V.dc("selectedItemIds",V.hc(11,v,t.selectedVereinsId))("items",t.vereine)("loading",t.loadingVereine)("multipleSelections",!t.multipleSelections)("placeholderTranslationKey",t.PLACEHOLDER_VAR)("optionFieldSelector","name"),V.xb(2),V.dc("config",t.config_table)("loading",t.loadingTable)("rows",t.rows))},directives:[w.a,E.a,T.a,y.a],styles:[".row[_ngcontent-%COMP%]{margin:20px;display:flex;flex-direction:column}"]}),e})();const I=[{path:"",pathMatch:"full",component:D},{path:"/:id",pathMatch:"full",component:D}];let O=(()=>{class e{}return e.\u0275mod=V.Hb({type:e}),e.\u0275inj=V.Gb({factory:function(t){return new(t||e)},imports:[[i.c,a.g.forChild(I),l.a,s.k]]}),e})()}}]);